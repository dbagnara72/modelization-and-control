
/*
 * This file is autogenerated by Simulink_GenerateWrapper.py
 * 
 * Date: 2025-07-10, Time: 11:23:21
 * Module: derivative_observer
 *
 */

#include  <derivative_observer_simulink.h>

derivative_observer_sim_t DerivativeObserver_Simulate(float timebase, float f_nom, float l_x, float l_x_dot, float l_x_dot_dot, float input, int reset_simulink, int enable_simulink)
{
    static derivative_obs_t derivative_observer = { 0 };
    static int initialized = 0;

    if (!initialized) {
		const derivative_obs_deps_t dependencies = {
			.timebase = &timebase
		};

        const derivative_obs_config_t config = {
            .f_nom = &f_nom,
			.l_x = &l_x,
			.l_x_dot = &l_x_dot,
			.l_x_dot_dot = &l_x_dot_dot
        };

        DerivativeObserver_Init(&derivative_observer, &dependencies, &config);

        initialized = 1;
    }

    if (reset_simulink) {
        DerivativeObserver_Reset(&derivative_observer);
    } else if (enable_simulink){
        DerivativeObserver_Process(&derivative_observer, input);
    }
    
    const derivative_observer_sim_t sim_output = {
		.x_hat = derivative_observer.x_hat,
        .x_dot_hat = derivative_observer.x_dot_hat,
		.x_dot_dot_hat = derivative_observer.x_dot_dot_hat
    };

    return sim_output;
}
